# 多表关系
* 一对多(多对一)
* 多对多
* 一对一

## 一对多(多对一)
* 案例: 部门 与 员工的关系
* 关系:一个部门对应多个员工,一个员工对应一个部门
* 实现:**在多的一方建立外键，指向一的一方的主键**,即在**员工里建立外键**
![image](https://github.com/user-attachments/assets/522d89cb-228a-4a4b-85bf-f3fc7ad136e6)




## 多对多
* 案例: 学生 与 课程的关系
* 关系:一个学生可以选修多门课程，一门课程也可以供多个学生选择
* 实现: **建立第三张中间表，中间表至少包含两个外键，分别关联两方主键**
![image](https://github.com/user-attachments/assets/7f29aafc-b2a6-45b3-bf7f-c6be1a830841)

例如：
```SQL
create table student(

   id int auto_increment primary key comment '主键ID',

   name varchar(10) comment '姓名',

   no varchar(10) comment '学号'

)comment ' 学生表';



insert into student values (null,'黛绮丝','2000100101'),(null,'谢逊','2000100102'),(null,'殷天正','2000100103'),(null,'韦一笑','2000100104');



create table course(

   id int auto_increment primary key comment '主键ID',

   name varchar(10) comment '课程名称'

)comment '课程表';



insert into course values (null,'Java'),(null,'PHP'),(null,'Mysql'),(null,'Hadoop');





create table student_course(

   id int auto_increment comment '主键' primary key,

   studentid int not null comment '学生ID',

   courseid int not null comment '课程ID',

   constraint fk_courseid foreign key (courseid) references course(id),

   constraint fk_studentid foreign key (studentid) references student(id)

)comment '学生课程中间表';



insert into student_course values (null,1,1),(null,1,2),(null,1,3),(null,2,3),(null,3,4);
```
![image](https://github.com/user-attachments/assets/eeaadb70-fac7-4863-a4c6-800f32cbc578)

![image](https://github.com/user-attachments/assets/cebc0691-97bf-4b8a-a827-d1dd2955f57f)


## 一对一
* 案例: 用户 与 用户详情的关系
* 关系:一对一关系，多用于单表拆分，将一张表的基础字段放在一张表中，其他详情字段放在另一张表中，以提升操作效率
* 实现:**在任意一方加入外键，关联另外一方的主键，并且设置外键为唯一的(UNIQUE)**
![image](https://github.com/user-attachments/assets/c7b9f6ac-62d3-43d5-bfe7-4b45418f2cd0)

* 例如：
```SQL
create  table tb_user(
    id int auto_increment primary key COMMENT '主键ID',
    name varchar(10) COMMENT '姓名',
    age int COMMENT '年龄',
    gender char(1) COMMENT '1:男， 2：女',
    phone char(11) COMMENT '手机号'
)comment '用户基本信息表';

create  table tb_user_edu(
    id int auto_increment primary key COMMENT '主键ID',
    degree varchar(20) COMMENT '学历',
    major varchar(50) COMMENT '专业',
    primaryschool varchar(50) COMMENT '小学',
    middleschool varchar(50) COMMENT '中学',
    university varchar(50) COMMENT '大学',
    userid int unique COMMENT '用户ID', --userid作为唯一外键
    constraint fk_userid foreign key  (userid) references  tb_user(id)
)comment '用户教育信息表';

insert into tb_user(id,name,age,gender,phone) values
(null,'黄渤',45,'1','18800001111'),
(null,'冰冰',35,'2','18800002222'),
(null,'码云',55,'1','18800008888' ),
(null,'李彦宏',50,'1','18800009999');

insert into tb_user_edu(id, degree, major, primaryschool, middleschool, university, userid) values
(null,'本科','舞蹈','静安区第一小学','静安区第一中学','北京舞蹈学院',1),
(null,'硕士','表演','朝阳区第一小学','朝阳区第一中学','北京电影学院',2),
(null,'本科','英语','杭州市第一小学','杭州市第一中学','杭州师范大学',3),
(null,'本科','应用数学','阳泉第一小学','阳泉区第一中学','清华大学',4);
```
![image](https://github.com/user-attachments/assets/4366ef63-7647-4ee8-8569-44b6c89dafc8)
![image](https://github.com/user-attachments/assets/550c2212-7b93-4d99-9479-d48bf24c6d1f)

## 多表查询
```
create table dept(
    id int primary key auto_increment,
    name varchar(10)
);

insert into dept values
     (null, '研发部'),
     (null, '市场部'),
     (null, '财务部'),
     (null, '销售部'),
     (null, '总经办'),
     (null, '人事部');

create table emp(
    id int primary key auto_increment,
    name varchar(10),
    age int,
    job varchar(10),
    salary int,
    entrydate date,
    managerid int,
    dept_id int,
    constraint fk_dept foreign key (dept_id) references dept(id)
);

insert into emp values
    (null, '金庸', 66, '总裁', 20000, '2000-01-01', null, 5),
    (null, '张无忌', 20, '项目经理', 12500, '2005-12-05', 1, 1),
    (null, '杨逍', 33, '开发', 8400, '2000-11-03', 2, 1),
    (null, '韦一笑', 48, '开发', 11000, '2002-02-05', 2, 1),
    (null, '常遇春', 43, '开发', 10500, '2004-09-07', 3, 1),
    (null, '小昭', 19, '程序员鼓励师', 6600, '2004-10-12', 2, 1),
    (null, '灭绝', 60, '财务总监', 8500, '2002-09-12', 1, 3),
    (null, '周芷若', 19, '会计', 4800, '2006-06-02', 7, 3),
    (null, '丁敏君', 23, '出纳', 5250, '2009-05-13', 7, 3),
    (null, '赵敏', 20, '市场部总监', 12500, '2004-10-12', 1, 2),
    (null, '鹿杖客', 56, '职员', 3750, '2006-10-03', 10, 2),
    (null, '鹤笔翁', 19, '职员', 3750, '2007-05-09', 10, 2),
    (null, '方东白', 19, '职员', 5500, '2009-02-12', 10, 2),
    (null, '张三丰', 88, '销售总监', 14000, '2004-10-12', 1, 4),
    (null, '俞莲舟', 38, '销售', 4600, '2004-10-12', 14, 4),
    (null, '宋远桥', 40, '销售', 4600, '2004-10-12', 14, 4),
    (null, '陈友谅', 42, null, 2000, '2011-10-12', 1, null);

create table salgrade(
    grade int,
    losal int,
    hisal int
);

insert into salgrade
values (1, 0, 3000),
       (2, 3001, 5000),
       (3, 5001, 8000),
       (4, 8001, 10000),
       (5, 10001, 15000),
       (6, 15001, 20000),
       (7, 20001, 25000),
       (8, 25001, 30000);
```
* 多表查询例子：
```SQL
SELECT * FROM EMP,dept; --笛卡尔积
```
![image](https://github.com/user-attachments/assets/457e8792-5e4d-46fb-bbbf-94a2ff955cd5)

* 消除无效的笛卡尔积：
```


```
